<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SeparatorMenuItem?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.text.Font?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.AreaChart?>
<?import javafx.scene.chart.StackedBarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="ui.HomeController"
            prefWidth="1400.0" prefHeight="800.0"
            styleClass="root-pane">

    <!-- HEADER -->
    <top>
        <VBox styleClass="header-container" spacing="0">
            <!-- Logo Section -->
            <HBox alignment="CENTER" spacing="0">
                <children>
                    <Region HBox.hgrow="ALWAYS"/>
                    <VBox spacing="0" alignment="CENTER" mouseTransparent="true">
                        <children>
                            <Region prefHeight="15.0" mouseTransparent="true"/>
                            <ImageView fx:id="headerLogoImageView" mouseTransparent="true">
                                <image>
                                    <Image url="@/images/logo.png"/>
                                </image>
                                <fitWidth>300.0</fitWidth>
                                <preserveRatio>true</preserveRatio>
                            </ImageView>
                            <Region prefHeight="10.0" mouseTransparent="true"/>
                        </children>
                    </VBox>
                    <Region HBox.hgrow="ALWAYS"/>
                </children>
                <padding>
                    <Insets top="8" right="32" bottom="0" left="32"/>
                </padding>
            </HBox>
            
            <!-- Navigation Buttons Below Logo -->
            <HBox styleClass="header-bar" alignment="CENTER" spacing="12" HBox.hgrow="ALWAYS">
                <children>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="Αρχική" onAction="#onNavigateHome" fx:id="homeButton" styleClass="header-nav-button" HBox.hgrow="NEVER"/>
                    <Button text="Προεπισκοπήσεις Αλλαγών" onAction="#onNavigateProjections" fx:id="projectionsButton" styleClass="header-nav-button" HBox.hgrow="NEVER"/>
                    <MenuButton text="Συγκρίσεις" fx:id="comparisonsMenuButton" styleClass="header-nav-button">
                        <items>
                            <MenuItem text="Σύγκριση ετών" onAction="#onNavigateComparison" fx:id="comparisonsMenuItem"/>
                            <MenuItem text="Σύγκριση κρατών" onAction="#onNavigateInternationalComparison" fx:id="internationalComparisonMenuItem"/>
                        </items>
                    </MenuButton>
                    <Button text="Στατιστικές Αναλύσεις" onAction="#onNavigateStatistics" fx:id="statisticsButton" styleClass="header-nav-button" HBox.hgrow="NEVER"/>
                    <Button text="AI Βοηθός" onAction="#onOpenAIAssistant" fx:id="aiAssistantButton" styleClass="header-nav-button" HBox.hgrow="NEVER"/>
                    <Button text="Σύνδεση ως Κυβέρνηση" onAction="#onAuthButtonClicked" fx:id="authButton" styleClass="government-auth-button" HBox.hgrow="NEVER"/>
                    <Region HBox.hgrow="ALWAYS"/>
                </children>
                <padding>
                    <Insets top="8" right="32" bottom="8" left="32"/>
                </padding>
            </HBox>
        </VBox>
    </top>

    <!-- CENTER CONTENT -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="content-scroll" vbarPolicy="AS_NEEDED" hbarPolicy="NEVER">
            <content>
                <VBox spacing="16" styleClass="content-container">
                    <padding>
                        <Insets top="16" right="80" bottom="16" left="80"/>
                    </padding>
                    <children>
                        
                                        <!-- HOME VIEW (Summary Cards) -->
                        <VBox fx:id="homeView" spacing="12" alignment="TOP_CENTER">
                            <children>
                                <!-- MAIN CONTENT: Year Selection + Summary Cards Full Width + Split Layout -->
                                <VBox spacing="12" alignment="TOP_CENTER">
                                    <children>
                                        <!-- Year Selection -->
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="yearComboBox" prefWidth="140" onAction="#onYearSelected" styleClass="year-combo-box"/>
                                                <Button text="Επεξεργασία" fx:id="editButton" onAction="#onEditButtonClicked" styleClass="year-combo-box" HBox.hgrow="NEVER"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        
                                        <!-- SUMMARY CARDS (Full Width) -->
                                        <VBox alignment="CENTER">
                                            <children>
                                                <HBox styleClass="summary-row" spacing="45" alignment="CENTER">
                                                    <children>
                                                        <Region HBox.hgrow="ALWAYS"/>
                                                <VBox styleClass="summary-card" spacing="6">
                                            <children>
                                                <Label text="Συνολικά Έσοδα" styleClass="summary-label"/>
                                                <Label fx:id="totalRevenuesLabel" text="€100,2 δισ." styleClass="summary-number"/>
                                                <Label fx:id="revenuesDeltaLabel" text="+2,3% από πέρυσι" styleClass="summary-delta positive"/>
                                            </children>
                                        </VBox>

                                                <VBox styleClass="summary-card" spacing="6">
                                            <children>
                                                <Label text="Συνολικές Δαπάνες" styleClass="summary-label"/>
                                                <Label fx:id="totalExpensesLabel" text="€98,5 δισ." styleClass="summary-number"/>
                                                <Label fx:id="expensesDeltaLabel" text="+1,1% από πέρυσι" styleClass="summary-delta positive"/>
                                            </children>
                                        </VBox>

                                                <VBox styleClass="summary-card" spacing="6">
                                            <children>
                                                <Label text="Ισοζύγιο" styleClass="summary-label"/>
                                                <Label fx:id="balanceLabel" text="+€1,7 δισ." styleClass="summary-number"/>
                                                <Label fx:id="balanceStatusLabel" text="Πλεόνασμα" styleClass="summary-delta positive"/>
                                            </children>
                                        </VBox>
                                                        <Region HBox.hgrow="ALWAYS"/>
                                                    </children>
                                                </HBox>
                                            </children>
                                        </VBox>

                                        <!-- SPLIT LAYOUT: Quick Nav Cards (Left) | Line Chart (Right) -->
                                        <GridPane hgap="20" vgap="0" alignment="CENTER">
                                            <columnConstraints>
                                                <ColumnConstraints hgrow="ALWAYS" minWidth="600" prefWidth="650"/>
                                                <ColumnConstraints hgrow="ALWAYS" minWidth="600" prefWidth="650"/>
                                            </columnConstraints>
                                            <rowConstraints>
                                                <RowConstraints vgrow="ALWAYS" prefHeight="420"/>
                                            </rowConstraints>
                                            
                                            <!-- LEFT: QUICK NAVIGATION CARDS -->
                                            <VBox spacing="16" GridPane.columnIndex="0">
                                                <GridPane.margin>
                                                    <Insets top="32" right="0" bottom="0" left="0"/>
                                                </GridPane.margin>
                                    <children>
                                                    <!-- QUICK NAVIGATION CARDS (2x2 Grid) -->
                                                    <GridPane hgap="12" vgap="12">
                                                        <columnConstraints>
                                                            <ColumnConstraints hgrow="ALWAYS" minWidth="280"/>
                                                            <ColumnConstraints hgrow="ALWAYS" minWidth="280"/>
                                                        </columnConstraints>
                                                        <rowConstraints>
                                                            <RowConstraints vgrow="ALWAYS" prefHeight="170"/>
                                                            <RowConstraints vgrow="ALWAYS" prefHeight="170"/>
                                                        </rowConstraints>
                                                        
                                                        <VBox styleClass="quick-nav-card" spacing="6" fx:id="quickNavMinistries" alignment="CENTER" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                    <children>
                                                        <Label text="1" styleClass="quick-nav-number"/>
                                                        <Label text="Υπουργεία &amp; Φορείς" styleClass="quick-nav-title"/>
                                                                <Label text="Ανάλυση Δαπανών ανά Υπουργείο" styleClass="quick-nav-description"/>
                                                                <HBox spacing="4" alignment="CENTER">
                                                                    <children>
                                                                        <Label text="Δείτε περισσότερα" styleClass="quick-nav-link" style="-fx-font-size: 12px;"/>
                                                                        <Label text="→" styleClass="quick-nav-link"/>
                                                                    </children>
                                                                </HBox>
                                                    </children>
                                                </VBox>

                                                        <VBox styleClass="quick-nav-card" spacing="6" fx:id="quickNavRevenues" alignment="CENTER" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                    <children>
                                                        <Label text="2" styleClass="quick-nav-number"/>
                                                        <Label text="Έσοδα" styleClass="quick-nav-title"/>
                                                                <Label text="Ανάλυση Εσόδων" styleClass="quick-nav-description"/>
                                                                <HBox spacing="4" alignment="CENTER">
                                                                    <children>
                                                                        <Label text="Δείτε περισσότερα" styleClass="quick-nav-link" style="-fx-font-size: 12px;"/>
                                                                        <Label text="→" styleClass="quick-nav-link"/>
                                                                    </children>
                                                                </HBox>
                                                    </children>
                                                </VBox>

                                                        <VBox styleClass="quick-nav-card" spacing="6" fx:id="quickNavExpenses" alignment="CENTER" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label text="3" styleClass="quick-nav-number"/>
                                                        <Label text="Δαπάνες" styleClass="quick-nav-title"/>
                                                                <Label text="Ανάλυση Δαπανών ανά Είδος" styleClass="quick-nav-description"/>
                                                                <HBox spacing="4" alignment="CENTER">
                                                                    <children>
                                                                        <Label text="Δείτε περισσότερα" styleClass="quick-nav-link" style="-fx-font-size: 12px;"/>
                                                                        <Label text="→" styleClass="quick-nav-link"/>
                                                                    </children>
                                                                </HBox>
                                                    </children>
                                                </VBox>

                                                        <VBox styleClass="quick-nav-card" spacing="6" fx:id="quickNavAdministrations" alignment="CENTER" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label text="4" styleClass="quick-nav-number"/>
                                                        <Label text="Αποκεντρωμένες Διοικήσεις" styleClass="quick-nav-title"/>
                                                                <Label text="Γεωγραφική Κατανομή Δαπανών" styleClass="quick-nav-description"/>
                                                                <HBox spacing="4" alignment="CENTER">
                                                                    <children>
                                                                        <Label text="Δείτε περισσότερα" styleClass="quick-nav-link" style="-fx-font-size: 12px;"/>
                                                                        <Label text="→" styleClass="quick-nav-link"/>
                                                                    </children>
                                                                </HBox>
                                                    </children>
                                                </VBox>
                                                    </GridPane>
                                            </children>
                                            </VBox>

                                            <!-- RIGHT: LINE CHART -->
                                            <VBox spacing="12" GridPane.columnIndex="1">
                                                <children>
                                                    <!-- LINE CHART -->
                                                    <VBox styleClass="section-card chart-card" spacing="8" VBox.vgrow="ALWAYS">
                                                        <padding>
                                                            <Insets top="16" right="16" bottom="16" left="16"/>
                                                        </padding>
                                                        <children>
                                                            <LineChart fx:id="lineHistory" title="Πορεία Προϋπολογισμού" prefHeight="250" legendVisible="true" animated="false" VBox.vgrow="ALWAYS">
                                                                <xAxis>
                                                                    <CategoryAxis label="Έτος" />
                                                                </xAxis>
                                                                <yAxis>
                                                                    <NumberAxis label="Ποσό (€)" />
                                                                </yAxis>
                                                            </LineChart>
                                                        </children>
                                                    </VBox>
                                                </children>
                                            </VBox>
                                        </GridPane>
                                    </children>
                                </VBox>

                            </children>
                        </VBox>

                        <!-- MINISTRIES VIEW -->
                        <VBox fx:id="ministriesView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="12" alignment="TOP_CENTER">
                                    <children>
                                        <Label text="Υπουργεία &amp; Φορείς" styleClass="section-title" style="-fx-alignment: CENTER;"/>
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="ministriesYearComboBox" prefWidth="130" visible="true" managed="true" onAction="#onMinistriesYearSelected" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                                <GridPane hgap="16" vgap="16">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints vgrow="ALWAYS" prefHeight="350"/>
                                    </rowConstraints>
                                    <children>
                                        <!-- Pie Chart - Top Ministries -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <PieChart fx:id="pieMinistries" title="Κορυφαία Υπουργεία" prefHeight="300" legendVisible="false" VBox.vgrow="ALWAYS"/>
                                            </children>
                                        </VBox>
                                        <!-- Area Chart - Historical Trend -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <AreaChart fx:id="areaMinistriesTrend" title="Εξέλιξη Δαπανών Υπουργείων" prefHeight="300" legendVisible="false" VBox.vgrow="ALWAYS">
                                                    <xAxis>
                                                        <CategoryAxis label="Έτος" />
                                                    </xAxis>
                                                    <yAxis>
                                                        <NumberAxis label="Ποσό (€)" />
                                                    </yAxis>
                                                </AreaChart>
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                                <VBox styleClass="section-card" spacing="16">
                                    <padding>
                                        <Insets top="24" right="24" bottom="48" left="24"/>
                                    </padding>
                                    <children>
                                        <TableView fx:id="categoryTable" prefHeight="600">
                                            <columns>
                                                <TableColumn fx:id="categoryColumn" text="Υπουργείο / Φορέας" prefWidth="400"/>
                                                <TableColumn fx:id="amountColumn" text="Δαπάνες (€)" prefWidth="220"/>
                                                <TableColumn fx:id="percentageColumn" text="Συμμετοχή (%)" prefWidth="180"/>
                                                <TableColumn fx:id="changeColumn" text="Μεταβολή από προηγούμενο έτος" prefWidth="250"/>
                                            </columns>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- REVENUES VIEW -->
                        <VBox fx:id="revenuesView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="12" alignment="TOP_CENTER">
                                    <children>
                                        <Label text="Έσοδα" styleClass="section-title" style="-fx-alignment: CENTER;"/>
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="revenuesYearComboBox" prefWidth="130" visible="true" managed="true" onAction="#onRevenuesYearSelected" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                                <GridPane hgap="16" vgap="16">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints vgrow="ALWAYS" prefHeight="300"/>
                                    </rowConstraints>
                                    <children>
                                        <!-- Pie Chart -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <PieChart fx:id="pieRevenue" title="" prefHeight="250" legendVisible="false" VBox.vgrow="ALWAYS"/>
                                            </children>
                                        </VBox>
                                        <!-- Area Chart - Historical Trend -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <AreaChart fx:id="areaRevenueTrend" title="" prefHeight="250" legendVisible="false" VBox.vgrow="ALWAYS">
                                                    <xAxis>
                                                        <CategoryAxis label="Έτος" />
                                                    </xAxis>
                                                    <yAxis>
                                                        <NumberAxis label="Ποσό (€)" />
                                                    </yAxis>
                                                </AreaChart>
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                                <VBox styleClass="section-card" spacing="16">
                                    <padding>
                                        <Insets top="24" right="24" bottom="24" left="24"/>
                                    </padding>
                                    <children>
                                        <Label text="Λεπτομερής Ανάλυση Εσόδων" styleClass="section-title"/>
                                        <TableView fx:id="revenuesTable" prefHeight="600">
                                            <columns>
                                                <TableColumn fx:id="revenueCategoryColumn" text="Είδος Έσοδων" prefWidth="450"/>
                                                <TableColumn fx:id="revenueAmountColumn" text="Ποσό (€)" prefWidth="280"/>
                                                <TableColumn fx:id="revenuePercentageColumn" text="Συμμετοχή (%)" prefWidth="220"/>
                                            </columns>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- EXPENSES VIEW -->
                        <VBox fx:id="expensesView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="12" alignment="TOP_CENTER">
                                    <children>
                                        <Label text="Δαπάνες" styleClass="section-title" style="-fx-alignment: CENTER;"/>
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="expensesYearComboBox" prefWidth="130" visible="true" managed="true" onAction="#onExpensesYearSelected" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                                <GridPane hgap="16" vgap="16">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints vgrow="ALWAYS" prefHeight="300"/>
                                    </rowConstraints>
                                    <children>
                                        <!-- Pie Chart -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <PieChart fx:id="pieExpenses" title="Κατηγορίες Δαπανών" prefHeight="250" legendVisible="false" VBox.vgrow="ALWAYS"/>
                                            </children>
                                        </VBox>
                                        <!-- Area Chart - Historical Trend -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <AreaChart fx:id="areaExpenseTrend" title="Εξέλιξη Δαπανών" prefHeight="250" legendVisible="false" VBox.vgrow="ALWAYS">
                                                    <xAxis>
                                                        <CategoryAxis label="Έτος" />
                                                    </xAxis>
                                                    <yAxis>
                                                        <NumberAxis label="Ποσό (€)" />
                                                    </yAxis>
                                                </AreaChart>
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                                <VBox styleClass="section-card" spacing="16">
                                    <padding>
                                        <Insets top="24" right="24" bottom="24" left="24"/>
                                    </padding>
                                    <children>
                                        <Label text="Λεπτομερής Ανάλυση Δαπανών" styleClass="section-title"/>
                                        <TableView fx:id="expensesTable" prefHeight="600">
                                            <columns>
                                                <TableColumn fx:id="expenseCategoryColumn" text="Είδος Δαπανών" prefWidth="450"/>
                                                <TableColumn fx:id="expenseAmountColumn" text="Ποσό (€)" prefWidth="280"/>
                                                <TableColumn fx:id="expensePercentageColumn" text="Συμμετοχή (%)" prefWidth="220"/>
                                            </columns>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- ADMINISTRATIONS VIEW -->
                        <VBox fx:id="administrationsView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="12" alignment="TOP_CENTER">
                                    <children>
                                        <Label text="Αποκεντρωμένες Διοικήσεις" styleClass="section-title" style="-fx-alignment: CENTER;"/>
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="administrationsYearComboBox" prefWidth="130" visible="true" managed="true" onAction="#onAdministrationsYearSelected" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                                <GridPane hgap="16" vgap="16">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                        <ColumnConstraints hgrow="ALWAYS" minWidth="400"/>
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints vgrow="ALWAYS" prefHeight="350"/>
                                    </rowConstraints>
                                    <children>
                                        <!-- Bar Chart - Top Administrations -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <BarChart fx:id="barAdministrationsTop" title="Top Διοικήσεις" prefHeight="300" legendVisible="false" VBox.vgrow="ALWAYS">
                                                    <xAxis>
                                                        <CategoryAxis label="Διοίκηση" />
                                                    </xAxis>
                                                    <yAxis>
                                                        <NumberAxis label="Ποσό (€)" />
                                                    </yAxis>
                                                </BarChart>
                                            </children>
                                        </VBox>
                                        <!-- Area Chart - Historical Trend -->
                                        <VBox styleClass="section-card chart-card" spacing="12" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <AreaChart fx:id="areaAdministrationsTrend" title="Διαχρονική Εξέλιξη Δαπανών Αποκεντρωμένων Διοικήσεων" prefHeight="300" legendVisible="false" VBox.vgrow="ALWAYS">
                                                    <xAxis>
                                                        <CategoryAxis label="Έτος" />
                                                    </xAxis>
                                                    <yAxis>
                                                        <NumberAxis label="Ποσό (€)" />
                                                    </yAxis>
                                                </AreaChart>
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                                <VBox styleClass="section-card" spacing="16">
                                    <padding>
                                        <Insets top="24" right="24" bottom="64" left="24"/>
                                    </padding>
                                    <children>
                                        <TableView fx:id="administrationsTable" prefHeight="250">
                                            <columns>
                                                <TableColumn fx:id="adminCategoryColumn" text="Αποκεντρωμένη Διοίκηση" prefWidth="550"/>
                                                <TableColumn fx:id="adminAmountColumn" text="Ποσό (€)" prefWidth="280"/>
                                                <TableColumn fx:id="adminPercentageColumn" text="Συμμετοχή (%)" prefWidth="220"/>
                                            </columns>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>
                        
                      
                        
                        <!-- DATA EXPLORATION VIEW -->
                        <VBox fx:id="dataExplorationView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="16" alignment="TOP_CENTER">
                                    <padding>
                                        <Insets top="16" right="80" bottom="16" left="80"/>
                                    </padding>
                                    <children>
                                        <!-- Title -->
                                        <HBox spacing="16" alignment="CENTER_LEFT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Label text="Σύγκριση Ετών" styleClass="section-title"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        
                                <HBox spacing="20" alignment="TOP_LEFT">
                                    <children>
                                        <!-- Sidebar with view categories -->
                                        <VBox fx:id="explorationSidebar" spacing="12" styleClass="exploration-sidebar" prefWidth="280">
                                            <padding>
                                                <Insets top="20" right="16" bottom="20" left="16"/>
                                            </padding>
                                            <children>
                                                <Label text="Τύπος Προβολής" styleClass="section-title" style="-fx-font-size: 16px; -fx-padding: 6 0 8 0;"/>
                                                
                                                <Button text="Συνολικά Έσοδα/Δαπάνες" onAction="#onSelectExplorationView" fx:id="exploreTotalButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                                <Button text="Ανά Υπουργείο" onAction="#onSelectExplorationView" fx:id="exploreMinistryButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                                <Button text="Ανά Κατηγορία Έσόδων" onAction="#onSelectExplorationView" fx:id="exploreRevenueCategoryButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                                <Button text="Ανά Κατηγορία Δαπανών" onAction="#onSelectExplorationView" fx:id="exploreExpenseCategoryButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                                <Button text="Σύγκριση Ετών" onAction="#onComparisonYearsClicked" fx:id="exploreComparisonButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                                <Button text="Τάσεις &amp; Αλλαγές" onAction="#onSelectExplorationView" fx:id="exploreTrendsButton" styleClass="exploration-category-button" style="-fx-alignment: CENTER_LEFT;"/>
                                            </children>
                                        </VBox>
                                        
                                        <!-- Main content area -->
                                        <VBox spacing="24" HBox.hgrow="ALWAYS" alignment="CENTER">
                                            <children>
                                                <!-- Comparison Controls and Overview Chart - Side by side -->
                                                <HBox fx:id="comparisonAndChartContainer" spacing="20" alignment="CENTER_LEFT" visible="true" managed="true">
                                                    <children>
                                                        <!-- Comparison Controls - Left side -->
                                                        <VBox fx:id="exploreComparisonControls" spacing="16" alignment="CENTER" visible="true" managed="true" styleClass="section-card">
                                                            <padding>
                                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                                            </padding>
                                                            <children>
                                                                <HBox spacing="16" alignment="CENTER">
                                                                    <children>
                                                                        <ComboBox fx:id="exploreYear1ComboBox" prefWidth="180" styleClass="year-combo-box" promptText="Επιλογή έτους 1"/>
                                                                        <ComboBox fx:id="exploreYear2ComboBox" prefWidth="180" styleClass="year-combo-box" promptText="Επιλογή έτους 2"/>
                                                                    </children>
                                                                </HBox>
                                                                <Button text="OK" onAction="#onLoadComparison" styleClass="comparison-ok-button" fx:id="exploreLoadComparisonButton"/>
                                                            </children>
                                                        </VBox>
                                                        
                                                        <!-- Overview Chart - Right side -->
                                                        <VBox fx:id="overviewChartsContainer" spacing="12" styleClass="section-card" visible="true" managed="true" HBox.hgrow="ALWAYS">
                                                            <padding>
                                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                                            </padding>
                                                            <children>
                                                                <!-- Revenue and Expenses Trends Line Chart -->
                                                                <LineChart fx:id="overviewTrendsChart" title="Εξέλιξη Εσόδων και Δαπανών" prefHeight="350" prefWidth="700">
                                                                    <xAxis>
                                                                        <CategoryAxis label="Έτη" animated="false"/>
                                                                    </xAxis>
                                                                    <yAxis>
                                                                        <NumberAxis label="Ποσό (€)"/>
                                                                    </yAxis>
                                                                </LineChart>
                                                            </children>
                                                        </VBox>
                                                    </children>
                                                </HBox>
                                                
                                                <!-- Dynamic filters for other views -->
                                                <VBox fx:id="exploreDynamicFilters" spacing="12" visible="false" managed="false">
                                                    <children>
                                                        <Label text="Υπουργείο:" styleClass="section-subtitle" fx:id="exploreMinistryLabel" visible="false" managed="false"/>
                                                        <ComboBox fx:id="exploreMinistryComboBox" prefWidth="250" visible="false" managed="false" onAction="#onExploreFilterChanged" styleClass="year-combo-box"/>
                                                        
                                                        <Label text="Κατηγορία Έσόδων:" styleClass="section-subtitle" fx:id="exploreRevenueCategoryLabel" visible="false" managed="false"/>
                                                        <ComboBox fx:id="exploreRevenueCategoryComboBox" prefWidth="250" visible="false" managed="false" onAction="#onExploreFilterChanged" styleClass="year-combo-box"/>
                                                        
                                                        <Label text="Κατηγορία Δαπανών:" styleClass="section-subtitle" fx:id="exploreExpenseCategoryLabel" visible="false" managed="false"/>
                                                        <ComboBox fx:id="exploreExpenseCategoryComboBox" prefWidth="250" visible="false" managed="false" onAction="#onExploreFilterChanged" styleClass="year-combo-box"/>
                                                        
                                                        <HBox spacing="8" alignment="CENTER_LEFT" visible="true">
                                                            <children>
                                                                <ComboBox fx:id="exploreYearComboBox" prefWidth="120" onAction="#onExploreYearSelected" styleClass="year-combo-box"/>
                                                            </children>
                                                        </HBox>
                                                    </children>
                                                </VBox>
                                                
                                                <!-- Results table -->
                                                <TableView fx:id="exploreResultsTable" prefHeight="400" VBox.vgrow="NEVER" visible="false" managed="false">
                                                    <columns>
                                                        <TableColumn fx:id="exploreColumn1" text="Κατηγορία" prefWidth="350" sortable="true"/>
                                                        <TableColumn fx:id="exploreColumn2" text="Έτος 1 (€)" prefWidth="200" sortable="true"/>
                                                        <TableColumn fx:id="exploreColumn3" text="Έτος 2 (€)" prefWidth="200" sortable="true"/>
                                                        <TableColumn fx:id="exploreColumn4" text="Διαφορά (€)" prefWidth="200" sortable="true"/>
                                                        <TableColumn fx:id="exploreColumn5" text="Αλλαγή" prefWidth="150" sortable="true"/>
                                                    </columns>
                                                </TableView>
                                                
                                                <!-- Comparison Charts -->
                                                <VBox spacing="12" styleClass="section-card" visible="false" managed="false" fx:id="yearComparisonChartContainer">
                                                    <padding>
                                                        <Insets top="20" right="20" bottom="20" left="20"/>
                                                    </padding>
                                                    <children>
                                                        <Label text="Γραφική Αναπαράσταση" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                        
                                                        <!-- Revenue vs Expenses Comparison -->
                                                        <BarChart fx:id="yearComparisonRevenueExpensesChart" title="Έσοδα vs Δαπάνες" prefHeight="400" prefWidth="800">
                                                            <xAxis>
                                                                <CategoryAxis fx:id="yearCompRevExpXAxis" label="Έτη"/>
                                                            </xAxis>
                                                            <yAxis>
                                                                <NumberAxis fx:id="yearCompRevExpYAxis" label="Ποσό (€)"/>
                                                            </yAxis>
                                                        </BarChart>
                                                    </children>
                                                </VBox>
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- AI ASSISTANT VIEW -->
                        <VBox fx:id="aiAssistantView" spacing="0" visible="false" managed="false">
                            <children>
                                <VBox spacing="16" alignment="TOP_CENTER" VBox.vgrow="ALWAYS">
                                    <padding>
                                        <Insets top="16" right="80" bottom="16" left="80"/>
                                    </padding>
                                    <children>
                                        <HBox spacing="16" alignment="CENTER_LEFT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Label text="🤖 AI Βοηθός Προϋπολογισμού" styleClass="section-title" style="-fx-font-size: 24px;"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        
                                        <VBox fx:id="aiConfigAlertContainer" 
                                              styleClass="config-alert-container"
                                              spacing="12"
                                              alignment="CENTER"
                                              visible="false"
                                              managed="false">
                                            <padding>
                                                <Insets top="20" right="40" bottom="20" left="40"/>
                                            </padding>
                                            <children>
                                                <Label text="⚠️" style="-fx-font-size: 36px;"/>
                                                <Label text="Το AI Βοηθός χρειάζεται API Key (Προαιρετικό)" styleClass="config-alert-title" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                                <Label text="Για να χρησιμοποιήσετε τον AI Βοηθό, πρέπει να ρυθμίσετε ένα API Key από έναν πάροχο AI (π.χ. OpenAI).&#10;&#10;Σημείωση: Το OpenAI προσφέρει δωρεάν πίστωση ($5-18) για νέους λογαριασμούς, αρκετή για demos και universitary projects.&#10;&#10;Μπορείτε να κλείσετε αυτό το παράθυρο αν δεν θέλετε να χρησιμοποιήσετε το AI Βοηθό - η εφαρμογή λειτουργεί πλήρως χωρίς αυτό." 
                                                       styleClass="config-alert-text"
                                                       wrapText="true"
                                                       textAlignment="CENTER"/>
                                                <TextField fx:id="aiApiKeyField" 
                                                          promptText="Εισάγετε το API Key σας..."
                                                          prefWidth="400"
                                                          prefHeight="40"
                                                          styleClass="api-key-field"/>
                                                <HBox spacing="12" alignment="CENTER">
                                                    <Button text="💾 Αποθήκευση" onAction="#onSaveAiApiKey" styleClass="save-api-key-button" prefWidth="140" prefHeight="40"/>
                                                </HBox>
                                            </children>
                                        </VBox>
                                        
                                        <ScrollPane fx:id="aiChatScrollPane" 
                                                    styleClass="chat-scroll-pane"
                                                    VBox.vgrow="ALWAYS"
                                                    fitToWidth="true"
                                                    hbarPolicy="NEVER"
                                                    vbarPolicy="AS_NEEDED">
                                            <content>
                                                <VBox fx:id="aiChatMessagesContainer" 
                                                      styleClass="chat-messages-container"
                                                      spacing="12">
                                                    <padding>
                                                        <Insets top="20" right="20" bottom="20" left="20"/>
                                                    </padding>
                                                </VBox>
                                            </content>
                                        </ScrollPane>
                                        
                                        <VBox styleClass="chat-input-container" spacing="8" VBox.vgrow="NEVER">
                                            <padding>
                                                <Insets top="12" right="20" bottom="12" left="20"/>
                                            </padding>
                                            <children>
                                                <HBox spacing="12" alignment="CENTER_LEFT">
                                                    <TextField fx:id="aiMessageInputField" 
                                                              promptText="Γράψτε την ερώτησή σας..."
                                                              prefHeight="45"
                                                              HBox.hgrow="ALWAYS"
                                                              styleClass="message-input-field"
                                                              onAction="#onSendAiMessage"/>
                                                    <Button text="📤 Αποστολή" 
                                                           onAction="#onSendAiMessage" 
                                                           styleClass="send-button"
                                                           prefWidth="120"
                                                           prefHeight="45"
                                                           fx:id="aiSendButton"/>
                                                </HBox>
                                                <HBox spacing="8" alignment="CENTER_LEFT">
                                                    <Label text="💡" style="-fx-font-size: 14px;"/>
                                                    <Label text="Παράδειγμα: 'Ποια είναι τα μεγαλύτερα έσοδα του 2024;'" 
                                                           styleClass="hint-text"
                                                           style="-fx-font-size: 12px; -fx-text-fill: #64748b;"/>
                                                </HBox>
                                            </children>
                                        </VBox>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- INTERNATIONAL COMPARISON VIEW -->
                        <VBox fx:id="internationalComparisonView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="16" alignment="TOP_CENTER">
                                    <padding>
                                        <Insets top="16" right="80" bottom="16" left="80"/>
                                    </padding>
                                    <children>
                                        <!-- Title -->
                                        <HBox spacing="16" alignment="CENTER_LEFT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Label text="Σύγκριση Κρατών" styleClass="section-title"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        <!-- Controls and All Countries Table -->
                                        <HBox spacing="20" alignment="TOP_LEFT">
                                            <children>
                                                <VBox spacing="16" styleClass="section-card" alignment="CENTER" HBox.hgrow="NEVER">
                                                    <padding>
                                                        <Insets top="20" right="20" bottom="20" left="20"/>
                                                    </padding>
                                                    <children>
                                                        <VBox spacing="12" alignment="CENTER_LEFT">
                                                            <children>
                                                                <ComboBox fx:id="internationalYearComboBox" prefWidth="200" styleClass="year-combo-box" style="-fx-font-size: 13px; -fx-padding: 8 16;" promptText="Επιλογή έτους"/>
                                                                <ComboBox fx:id="internationalCountry1ComboBox" prefWidth="200" styleClass="year-combo-box" style="-fx-font-size: 13px; -fx-padding: 8 16;" promptText="Επιλογή κράτους 1"/>
                                                                <ComboBox fx:id="internationalCountry2ComboBox" prefWidth="200" styleClass="year-combo-box" style="-fx-font-size: 13px; -fx-padding: 8 16;" promptText="Επιλογή κράτους 2"/>
                                                            </children>
                                                        </VBox>
                                                        <Button text="OK" onAction="#onLoadInternationalComparison" styleClass="comparison-ok-button" fx:id="loadInternationalComparisonButton"/>
                                                    </children>
                                                </VBox>
                                                
                                                <VBox spacing="12" styleClass="section-card" HBox.hgrow="ALWAYS" visible="true" managed="true" fx:id="allCountriesTableContainer">
                                                    <padding>
                                                        <Insets top="20" right="20" bottom="20" left="20"/>
                                                    </padding>
                                                    <children>
                                                        <Label text="Όλες οι Χώρες" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                        <TableView fx:id="allCountriesTable" prefHeight="400" VBox.vgrow="ALWAYS" HBox.hgrow="ALWAYS">
                                                            <columns>
                                                                <TableColumn fx:id="allCountriesCountryColumn" text="Χώρα" prefWidth="150" sortable="true"/>
                                                                <TableColumn fx:id="allCountriesRevenueColumn" text="Έσοδα" prefWidth="200" sortable="true"/>
                                                                <TableColumn fx:id="allCountriesExpenseColumn" text="Δαπάνες" prefWidth="200" sortable="true"/>
                                                                <TableColumn fx:id="allCountriesBalanceColumn" text="Ισοζύγιο" prefWidth="200" sortable="true"/>
                                                            </columns>
                                                        </TableView>
                                                    </children>
                                                </VBox>
                                            </children>
                                        </HBox>
                                        
                                        <!-- Results -->
                                        <VBox spacing="12" styleClass="section-card" VBox.vgrow="ALWAYS" visible="false" managed="false" fx:id="internationalResultsContainer">
                                            <padding>
                                                <Insets top="20" right="20" bottom="20" left="20"/>
                                            </padding>
                                            <children>
                                                <Label fx:id="internationalComparisonTitle" text="" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                <TableView fx:id="internationalComparisonTable" prefHeight="400" VBox.vgrow="ALWAYS">
                                                    <columns>
                                                        <TableColumn fx:id="intIndicatorColumn" text="Κατηγορία" prefWidth="250" sortable="true"/>
                                                        <TableColumn fx:id="intCountry1Column" text="Κράτος 1" prefWidth="250" sortable="true"/>
                                                        <TableColumn fx:id="intCountry2Column" text="Κράτος 2" prefWidth="250" sortable="true"/>
                                                        <TableColumn fx:id="intDifferenceColumn" text="Διαφορά" prefWidth="200" sortable="true"/>
                                                    </columns>
                                                </TableView>
                                            </children>
                                        </VBox>
                                        
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- STATISTICS VIEW -->
                        <VBox fx:id="statisticsView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="16" alignment="TOP_CENTER">
                                    <padding>
                                        <Insets top="16" right="80" bottom="16" left="80"/>
                                    </padding>
                                    <children>
                                        <!-- Title -->
                                        <HBox spacing="16" alignment="CENTER_LEFT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Label text="Στατιστικές Αναλύσεις Προϋπολογισμού" styleClass="section-title"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        <Label text="Προχωρημένες στατιστικές αναλύσεις για έσοδα, δαπάνες και τάσεις" styleClass="section-subtitle"/>
                                        
                                        <!-- Year Selection -->
                                        <HBox spacing="12" alignment="CENTER_LEFT" styleClass="section-card">
                                            <padding>
                                                <Insets top="16" right="20" bottom="16" left="20"/>
                                            </padding>
                                            <children>
                                                <Label text="Περίοδος:" styleClass="section-subtitle"/>
                                                <Label text="Από:" styleClass="section-subtitle"/>
                                                <ComboBox fx:id="statisticsStartYearComboBox" prefWidth="120" styleClass="year-combo-box"/>
                                                <Label text="Έως:" styleClass="section-subtitle"/>
                                                <ComboBox fx:id="statisticsEndYearComboBox" prefWidth="120" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button text="🔄 Υπολογισμός Στατιστικών" onAction="#onCalculateStatistics" styleClass="action-button" fx:id="calculateStatisticsButton"/>
                                            </children>
                                        </HBox>
                                        
                                        <!-- Statistics Cards -->
                                        <GridPane hgap="20" vgap="20">
                                            <columnConstraints>
                                                <ColumnConstraints hgrow="ALWAYS" prefWidth="300"/>
                                                <ColumnConstraints hgrow="ALWAYS" prefWidth="300"/>
                                                <ColumnConstraints hgrow="ALWAYS" prefWidth="300"/>
                                            </columnConstraints>
                                            
                                            <!-- Revenues Statistics -->
                                            <VBox spacing="12" styleClass="section-card" GridPane.columnIndex="0">
                                                <padding>
                                                    <Insets top="20" right="20" bottom="20" left="20"/>
                                                </padding>
                                            <children>
                                                    <Label text="Στατιστικά Εσόδων" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                    <Label text="Μέσος Όρος:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueMeanLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Διάμεσος:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueMedianLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Τυπική Απόκλιση:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueStdDevLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Διακύμανση:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueVarianceLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Συντελεστής Μεταβλητότητας:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueCoeffVarLabel" text="-" styleClass="stat-value"/>
                                                </children>
                                            </VBox>
                                                
                                            <!-- Expenses Statistics -->
                                            <VBox spacing="12" styleClass="section-card" GridPane.columnIndex="1">
                                                <padding>
                                                    <Insets top="20" right="20" bottom="20" left="20"/>
                                                </padding>
                                                    <children>
                                                    <Label text="Στατιστικά Δαπανών" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                    <Label text="Μέσος Όρος:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseMeanLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Διάμεσος:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseMedianLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Τυπική Απόκλιση:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseStdDevLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Διακύμανση:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseVarianceLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Συντελεστής Μεταβλητότητας:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseCoeffVarLabel" text="-" styleClass="stat-value"/>
                                                </children>
                                            </VBox>
                                            
                                            <!-- Correlation & Trends -->
                                            <VBox spacing="12" styleClass="section-card" GridPane.columnIndex="2">
                                                <padding>
                                                    <Insets top="20" right="20" bottom="20" left="20"/>
                                                </padding>
                                                <children>
                                                    <Label text="Συσχέτιση &amp; Τάσεις" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                    <Label text="Συσχέτιση Έσόδων-Δαπανών:" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsCorrelationLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Τάση Εσόδων (γραμμική):" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsRevenueTrendLabel" text="-" styleClass="stat-value"/>
                                                    <Label text="Τάση Δαπανών (γραμμική):" styleClass="section-subtitle"/>
                                                    <Label fx:id="statsExpenseTrendLabel" text="-" styleClass="stat-value"/>
                                                    </children>
                                            </VBox>
                                                </GridPane>
                                                
                                        <!-- Outliers Table -->
                                        <VBox spacing="12" styleClass="section-card">
                                            <padding>
                                                <Insets top="24" right="24" bottom="24" left="24"/>
                                            </padding>
                                                    <children>
                                                <Label text="Ακραίες Τιμές (Outliers)" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                <Label text="Έτη με ασυνήθιστα υψηλές ή χαμηλές τιμές" styleClass="section-subtitle"/>
                                                
                                                <TableView fx:id="statisticsOutliersTable" prefHeight="200">
                                                    <columns>
                                                        <TableColumn fx:id="statsOutlierYearColumn" text="Έτος" prefWidth="100" sortable="true"/>
                                                        <TableColumn fx:id="statsOutlierTypeColumn" text="Τύπος" prefWidth="150" sortable="true"/>
                                                        <TableColumn fx:id="statsOutlierValueColumn" text="Τιμή (€)" prefWidth="200" sortable="true"/>
                                                        <TableColumn fx:id="statsOutlierZScoreColumn" text="Z-Score" prefWidth="150" sortable="true"/>
                                                    </columns>
                                                </TableView>
                                            </children>
                                        </VBox>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- PROJECTIONS/SIMULATIONS VIEW -->
                        <VBox fx:id="projectionsView" spacing="16" visible="false" managed="false">
                            <children>
                                <VBox spacing="16" alignment="TOP_CENTER">
                                    <padding>
                                        <Insets top="16" right="80" bottom="16" left="80"/>
                                    </padding>
                                    <children>
                                        <!-- Title -->
                                        <HBox spacing="16" alignment="CENTER">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Label text="Προσομοιώσεις Προϋπολογισμού" styleClass="section-title"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        
                                        <!-- Year Selection -->
                                        <HBox spacing="8" alignment="CENTER" style="-fx-padding: 0 0 16 0;">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <ComboBox fx:id="simulationBaseYearComboBox" onAction="#onSimulationBaseYearSelected" prefWidth="140" styleClass="year-combo-box"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                            </children>
                                        </HBox>
                                        
                                        <VBox spacing="8" alignment="TOP_CENTER">
                                            <children>
                                                <HBox spacing="16" alignment="TOP_LEFT">
                                                    <children>
                                                        <!-- Simulation Configuration -->
                                                        <VBox spacing="16" styleClass="section-card" HBox.hgrow="ALWAYS">
                                                            <padding>
                                                                <Insets top="24" right="24" bottom="24" left="24"/>
                                                            </padding>
                                                            <children>
                                                                <!-- Type Selection Tabs -->
                                                                <TabPane fx:id="simulationTypeTabPane" styleClass="simulation-tab-pane" tabMinHeight="0" tabMaxHeight="50">
                                                                    <tabs>
                                                                        <Tab text="Μεταβολή Εσόδων" closable="false"/>
                                                                        <Tab text="Μεταβολή Εξόδων" closable="false"/>
                                                                    </tabs>
                                                                </TabPane>
                                                                
                                                                <!-- Expenses Level Selection (shown only when Expenses tab is selected) -->
                                                                <HBox fx:id="expensesLevelContainer" spacing="12" alignment="CENTER" visible="false" managed="false">
                                                                    <children>
                                                                        <Region HBox.hgrow="ALWAYS"/>
                                                                        <ComboBox fx:id="simulationLevelComboBox" prefWidth="170.0" prefHeight="50" minHeight="50" maxHeight="50" onAction="#onSimulationLevelChanged" styleClass="year-combo-box"/>
                                                                        <Region HBox.hgrow="ALWAYS"/>
                                                                    </children>
                                                                </HBox>
                                                                
                                                                <!-- Multiple Selection Table -->
                                                                <TableView fx:id="simulationSelectionsTable" prefHeight="250" VBox.vgrow="ALWAYS">
                                                                    <columns>
                                                                        <TableColumn fx:id="simulationCheckColumn" text="" prefWidth="50" styleClass="check-box-table-cell"/>
                                                                        <TableColumn fx:id="simulationCategoryColumn" text="Κατηγορία" prefWidth="300"/>
                                                                        <TableColumn fx:id="simulationAmountColumn" text="Τρέχον Ποσό (€)" prefWidth="150"/>
                                                                        <TableColumn fx:id="simulationChangeColumn" text="Μεταβολή (%)" prefWidth="150"/>
                                                                    </columns>
                                                                </TableView>
                                                                
                                                                <!-- Default Change Percentage and Action Buttons -->
                                                                <HBox spacing="12" alignment="CENTER_LEFT">
                                                                    <children>
                                                                        <Label text="Προεπιλεγμένη Μεταβολή (%):" styleClass="section-subtitle" minHeight="38" prefHeight="38" maxHeight="38"/>
                                                                        <TextField fx:id="simulationDefaultChangeField" prefWidth="200" prefHeight="38" promptText="π.χ. 5% ή -5%"/>
                                                                        <Button text="Εφαρμογή σε όλες" onAction="#onApplyDefaultChange" styleClass="action-button" prefWidth="180" prefHeight="40"/>
                                                                        <Button text="Αποτελέσματα" onAction="#onCalculateSimulationResults" styleClass="action-button" prefWidth="200" prefHeight="40"/>
                                                                    </children>
                                                                </HBox>
                                                            </children>
                                                        </VBox>
                                                        
                                                        <!-- Results Display -->
                                                        <VBox spacing="12" styleClass="section-card" HBox.hgrow="ALWAYS">
                                                            <padding>
                                                                <Insets top="24" right="24" bottom="24" left="24"/>
                                                            </padding>
                                                            <children>
                                                                <Label text="Αποτελέσματα Προσομοίωσης" styleClass="section-title" style="-fx-font-size: 18px;"/>
                                                                <TextArea fx:id="simulationResultsArea" prefHeight="300" editable="false" wrapText="true" styleClass="simulation-results"/>
                                                            </children>
                                                        </VBox>
                                                    </children>
                                                </HBox>
                                            </children>
                                        </VBox>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </center>

    <!-- FOOTER -->
    <bottom>
        <HBox styleClass="footer-bar" spacing="16">
            <padding>
                <Insets top="12" right="32" bottom="12" left="32"/>
            </padding>
            <children>
                <Label text="e-budget v0.0.1" styleClass="footer-text"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label text="© 2026 - AUEB DMST" styleClass="footer-text"/>
                <Label text="|" styleClass="footer-separator"/>
                <Label text="Τεκμηρίωση" styleClass="footer-link"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>

